<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <style>
      #div,
      h1 {
        text-align: center;
      }
      #div2 {
        position: relative;
        left: 30%;
      }
      #busca {
        height: 25px;
        width: 150px;
      }
      #consonante,
      #vocal {
        height: 25px;
        width: 80px;
      }
    </style>
  </head>

  <body>
    <h1>Juego de letras</h1>
    <div id="div">
      <button id="consonante">consonante</button>
      <button id="vocal">vocal</button>
      <br />
      <input type="text" />
      <br />
      <button id="busca">buscar soluciones</button>
    </div>
    <div id="div2"></div>
  </body>

  <script>
    fetch("dic.txt")
      .then((d) => d.text())
      .then((palabras) => {
        let words = palabras.split(/\n|\s/);
        let ray = [];
        for (i in words) {
          if (words[i] != "") {
            ray.push(words[i].toUpperCase());
          }
        }

        let consonante = "B,C,D,F,G,H,J,K,L,M,N,Ñ,P,Q,R,S,T,V,X,Z,W,Y";
        consonante = consonante.split(/,/);

        let vocales = "A,E,I,O,U";
        vocales = vocales.split(/,/);

        let div2 = document.getElementById("div2");

        let conBtn = document.querySelector("#consonante");
        let vocBtn = document.querySelector("#vocal");
        let box = document.querySelector("input");
        let buscar = document.querySelector("#busca");
        let div2Text = document.querySelector("#div2");

        let deNletras = [];
        let cont = 9;
        while (cont > 2) {
          deNletras[cont] = `De ${cont} letras: `;

          cont--;
        }

        // str1 = user input
        // str2 = actual word
        /*   para este function , always start with
      user input as str1 , str2 is word extracted form dictionary */
        function contained(str1, str2) {
          str1 = str1.split("").sort().join("");
          str2 = str2.split("").sort().join("");
          let x = 0;
          str1 = removeDup(str1);
          str2 = removeDup(str2);
          /* la idea aqui es como ahora tenemos las 2 palabras sotreadas
         Y sus letras duplicadas quitadas, 
         corremos la palabra del diccionario y la comparamos con el input del usuario
         cada vez que encontramos la letra añadimos 1 a x
         si al final x es igual al tamaño de la letra entonces
          sabemos que str2 está incluido en str1
          */
          for (i in str2) {
            for (j in str1) {
              if (str2[i] == str1[j]) {
                x++;
              }
            }
          }

          return x == str2.length;
        }

        function removeDup(str1) {
          // funcion para quiter letras duplicadas
          let x = "";
          for (let i = 0; i < str1.length; i++) {
            if (str1[i] != str1[i + 1]) {
              x += str1[i];
            }
          }
          return x;
        }

        conBtn.addEventListener("click", function () {
          let randC = Math.floor(Math.random() * consonante.length); // de 0 a 21
          let letra = consonante[randC];
          box.value += letra;
        });

        vocBtn.addEventListener("click", function () {
          let randV = Math.floor(Math.random() * vocales.length);
          let letra = vocales[randV];
          box.value += letra;
        });

        buscar.addEventListener("click", function () {
          let texto = box.value;

          for (let i in ray) {
            if (contained(texto, ray[i])) {
              console.log(ray[i]);
            }
          }
        });
      });
  </script>
</html>
